<!DOCTYPE html>
<html>
<head>
  <title>Johans enhörningsdatabas</title>
  <meta charset="UTF-8">
  <style type="text/css">
  table {
    border-spacing: 10px;
    border-collapse: separate;
    cellspacing: 100px;
    width: 1200px;
  }
  td {
    border: 1px solid black;
    padding: 10px;
  }
  </style>
</head>

<body>
  <h1>Johans enhörningsdatabas</h1>

  <table>
    <tr>
      <td id="list">
        <ul id="unicorns">
          <li><a href="">Enhörning 1</a></li>
          <li><a href="">Enhörning 2</a></li>
          <li><a href="">Enhörning 3</a></li>
        </ul>
      </td>
  
      <td id="info">
        <h2 id="unicornName">Ingen enhörning</h2>
        <span id="unicornImage"></span>
        <p id="unicornInfo"></p>
        <p id="unicornSighting"></p>
        <img src="" alt="">
      </td>
    </tr>
  </table>

  <script>
    const basurl="http://unicorns.idioti.se"
    async function listUnicorns(){

      const options ={
         method : "get",

         headers:{"Accept": "application/json"}
      }

      const response = await fetch(basurl,options)
      const result = await response.json();
      const unicornList = document.querySelector("#unicorns");
      unicornList.replaceChildren();;

      result.forEach((unicorn) => {
      let listItem = document.createElement("li");
      listItem.setAttribute("name", "unicorn_" + unicorn.id);
      listItem.setAttribute("value", unicorn.id);
      listItem.innerHTML = unicorn.name;
      listItem.addEventListener("click", fetchThenDisplayUnicorn)
      unicornList.appendChild(listItem);
      });
    }  

      async function fetchThenDisplayUnicorn(event){
        const option ={
          method: "GET",
          headers:{"Accept": "application/json"}
        }

        const response = await fetch(basurl + "/"+event.target.value,option)
        const result = await response.json();
        console.log(result);
        displayUnicorn(result)

      }

      

      async function displayUnicorn(unicorn){
        
        document.querySelector("#unicornName").textContent = unicorn.name
        document.querySelector("#unicornInfo").textContent = unicorn.description
        unibild=document.createElement("img")
        unibild.src=unicorn.image
        document.querySelector("#unicornImage").replaceChildren(unibild)
      }

    

    listUnicorns()
  </script>
</body>
</html>
